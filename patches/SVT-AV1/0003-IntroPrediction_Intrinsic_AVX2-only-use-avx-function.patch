From a650a74ad68d18d687c58de2cc0e5170785855b6 Mon Sep 17 00:00:00 2001
From: Christopher Degawa <ccom@randomderp.com>
Date: Fri, 21 Jun 2019 23:38:14 -0500
Subject: [PATCH] IntroPrediction_Intrinsic_AVX2: only use avx functions if
 MSVC

Signed-off-by: Christopher Degawa <ccom@randomderp.com>
---
 .../Lib/Common/ASM_AVX2/EbIntraPrediction_Intrinsic_AVX2.c  | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/Source/Lib/Common/ASM_AVX2/EbIntraPrediction_Intrinsic_AVX2.c b/Source/Lib/Common/ASM_AVX2/EbIntraPrediction_Intrinsic_AVX2.c
index c75f9382..41d11b8a 100644
--- a/Source/Lib/Common/ASM_AVX2/EbIntraPrediction_Intrinsic_AVX2.c
+++ b/Source/Lib/Common/ASM_AVX2/EbIntraPrediction_Intrinsic_AVX2.c
@@ -2439,9 +2439,8 @@ void intra_mode_angular_34_avx2_intrin(
     }
 }
 
-// only define these intrinsics if immintrin.h doesn't have them 
-#ifdef _WIN32
-#if _MSC_VER < 1910
+// only define these intrinsics if immintrin.h doesn't have them
+#if defined(_MSC_VER) && _MSC_VER < 1910
 static inline int32_t _mm256_extract_epi32(__m256i a, const int32_t i)
 {
     return a.m256i_i32[i & 7];
@@ -2454,7 +2453,6 @@ static inline __m256i _mm256_insert_epi32(__m256i a, int32_t b, const int32_t i)
     return c;
 }
 #endif
-#endif
 
 #define PERM4x64(c0, c1, c2, c3) c0+(c1<<2)+(c2<<4)+(c3<<6)
 #define PERM2x128(c0, c1) c0+(c1<<4)
-- 
2.21.0

